(window.at_webpackJsonp=window.at_webpackJsonp||[]).push([[0],{MigZ:function(e,t,n){"use strict";const o=n("l9JQ"),r=n("mjZG"),i=n("cLOM"),a=(e,t,n)=>new Promise((o,r)=>{const a=new XMLHttpRequest;a.onload=function(){try{if(200===a.status)try{o(JSON.parse(a.response))}catch(e){o(a.response)}else r(new Error("xhrReq: Bad statusCode "+a.status))}catch(e){r(e)}},a.onerror=(e=>{0===e.target.status&&(i.warn("xhrReq onerror (status 0):",e),r(new Error("xhrReq: Failed")))}),a.open(t?"POST":"GET",e,!0),n&&a.setRequestHeader("Authorization","Bearer "+n),t&&a.setRequestHeader("Content-Type","application/json"),t?a.send(t):a.send()}),s={},c=e=>(s[e]||(s[e]=new Promise((t,n)=>{a(e).then(n=>{delete s[e],t(n)}).catch(t=>{delete s[e],n(t)})})),s[e]);e.exports={xhrReq:a,xhrReqGetDebounced:c,getContentUUID:async(e,t,n)=>{const a="content_uuid_"+e+"_"+t;let s;try{s=await o.getObject(a)}catch(e){i.warn("getContentUUID getObject Error",e,a)}if(s&&s.data&&s.data.uuid)return s.data.uuid;{const s=await(async(e,t,n)=>{const o=r.api_get_content_uuid+"?platformUUID="+encodeURIComponent(e)+"&contentName="+encodeURIComponent(t)+"&contentDisplayName="+encodeURIComponent(n),i=await c(o);if(i.success)return i;throw new Error("getContentUUIDFromAPI: API Call was unsuccessful!")})(e,t,n);try{await o.putObject(a,{data:s,contentName:t})}catch(e){i.warn("getContentUUID putObject Error",e,a,s)}return s.uuid}}}},cLOM:function(e,t,n){"use strict";const o=n("mjZG"),{getGuestUUID:r,uuidv4:i}=n("kLkQ"),a=n("tijG"),s=i();"toJSON"in Error.prototype||Object.defineProperty(Error.prototype,"toJSON",{value:function(){var e={};return Object.getOwnPropertyNames(this).forEach(function(t){e[t]=this[t]},this),e},configurable:!0,writable:!0});const c=(...e)=>{o.logging_enabled&&console.log(...e)};let d=[],u=void 0;const l=()=>(u||(u=new Promise(async(e,t)=>{try{if(0===d.length)return;if(!o.errorBeaconURL||""===o.errorBeaconURL)return;const t=a.amClient()?window.parent.location.hostname:location.hostname,n=a.amClient()?"client":"module",i={ts:Date.now(),hostname:t,loadUUID:s,data:d,userAgent:navigator.userAgent,scriptIdent:n};d=[],i.uuid=await r(),c("SendBeaconOnHidden Data:",i);const l=navigator.sendBeacon(o.errorBeaconURL,JSON.stringify(i));l||c("SendBeaconOnHidden Failed to queue",l),u=void 0,e(l)}catch(t){c("SendBeaconOnHidden Error:",t),u=void 0,e(!1)}})),u);let m=!1;const g=async(e,t)=>{try{if(!t)return;if(!("sendBeacon"in navigator))return;if(!o.errorBeaconURL||""===o.errorBeaconURL)return;m||(m=!0,document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&l()},!1),document.addEventListener("beforeunload",function(){l()},!1),document.addEventListener("unload",function(){l()},!1)),d.push({ts:Date.now(),type:e,information:t})}catch(e){c("setErrorBeacon Error:",e)}};e.exports={debug:c,log:(...e)=>{c(...e)},warn:(...e)=>{o.logging_enabled&&console.warn(...e),g("log-warn",e)},error:(...e)=>{o.logging_enabled&&console.error(...e),g("log-error",e)},addBeaconInformation:g}},k55v:function(e,t,n){"use strict";const o=n("cLOM"),r=n("mjZG"),i=n("tijG"),{IdGenerator:a,asyncDelay:s}=n("kLkQ"),c=a(),d={},u={},l={};u.hello=(e=>"hello "+e),u.explode=(()=>{throw new Error("BOOM")}),u.delayedEcho=(async e=>(await s(1e3),e));const m=(e,t,n,o,r)=>{n.postMessage({airtimeModuleRPC:!0,cmd:r?"callback-err":"callback",data:e,cbid:t},o)},g=(e,t,n)=>{d[t]&&(n?d[t].failure(e):d[t].callback(e))},f=async e=>{if(!(e instanceof Event))return;if(!e.isTrusted)return;if(!i.amClient()&&-1===r.clientFrameURL.indexOf(e.origin))return;const t=e.data;if(!0!==t.airtimeModuleRPC&&!0!==t.airtimeExtensionRPC||!t.hasOwnProperty("cmd")||!t.hasOwnProperty("data"))return;if(!0===t.airtimeExtensionRPC&&"callback"!==t.cmd&&"callback-err"!==t.cmd&&"firebaseAuthChanged"!==t.cmd)return;let n;switch(t.cmd){case"callback":return g(t.data,t.cbid,!1);case"callback-err":return g(t.data,t.cbid,!0);case"noAnswer":return;default:n=u[t.cmd]}if(n&&"function"==typeof n)try{let o;e.ports&&1===e.ports.length&&(o=e.ports[0]);const r=await n(t.data,o);t.cbid&&m(r,t.cbid,e.source,e.origin,!1)}catch(n){t.cbid&&m(n?n.message||n.toString():void 0,t.cbid,e.source,e.origin,!0)}else t.cbid&&m("Bad Command",t.cbid,e.source,e.origin,!0)},h=()=>{if(!this.promise){const e=this;this.promise=new Promise(async(t,n)=>{if(l.sidebar){t(await l.sidebar.getClientIframe())}else e.promise=void 0,n()})}return this.promise},p=(e,t,n=18e4,o=!1,a=!1)=>new Promise(async(s,u)=>{const l=c.get()+"";let m;const g=()=>{m&&clearTimeout(m),d[l]&&delete d[l]},f=e=>{g(),u(e)},p=e=>{g(),s(e)};try{n&&(m=setTimeout(f.bind(this,"Callback Timeout"),n)),d[l]={callback:p,failure:f};const s={airtimeModuleRPC:!o,airtimeExtensionRPC:o,cmd:e,data:t,cbid:l};await(async(e,t=!1,n)=>{let o;n&&n instanceof MessagePort&&(o=[n]),t?window.postMessage(e,"*",o):i.amClient()?window.parent.postMessage(e,"*",o):(await h()).contentWindow.postMessage(e,r.clientFrameURL,o)})(s,o,a)}catch(e){f(e)}});e.exports={sendMessage:p,messageHandlers:u,msgTests:async()=>{const e=i.amClient()?"child":"parent";let t=await p("hello",e);o.debug(e+" hello response:",t);try{t=await p("explode"),o.debug(e+" explode response:",t)}catch(t){o.debug(e+" explode failed as expected:",t)}try{t=await p("badCMD"),o.debug(e+" badCMD response:",t)}catch(t){o.debug(e+" badCMD failed as expected:",t)}try{t=await p("noAnswer",void 0,1e3),o.debug(e+" noAnswer response:",t)}catch(t){o.debug(e+" noAnswer failed as expected:",t)}t=await p("delayedEcho",{time:"lord",ident:e}),o.debug(e+" delayedEcho response:",t)},init:async()=>{window.addEventListener("message",f,!1)},bridge:l}},kLkQ:function(e,t,n){"use strict";(function(t){const o=n("cLOM"),r=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),i=e=>{return!!(e=e.toLowerCase()).match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/)};let a=!1;let s=!1;const c=e=>!!e&&"function"==(typeof e).toLowerCase()&&(e===Function.prototype||/^\s*function\s*(\b[a-z$_][a-z0-9$_]*\b)*\s*\((|([a-z$_][a-z0-9$_]*)(\s*,[a-z$_][a-z0-9$_]*)*)\)\s*{\s*\[native code\]\s*}\s*$/i.test(String(e))),d=e=>{try{const t=document.createElement("iframe");t.height=t.width=0,document.documentElement.appendChild(t);const n=t.contentWindow[e];return document.documentElement.removeChild(t),n.bind(window)}catch(t){o.warn("getNativeFunction Err:",t,e)}},u=function(e){let t;return function(){const n=this,o=arguments;t&&window.cancelAnimationFrame(t),t=window.requestAnimationFrame(function(){t=void 0,e.apply(n,o)})}};function*l(){for(var e=0;;)yield e++}l.prototype.get=function(){return this.next().value};let m;e.exports={uuidv4:r,isValidUUID:i,detectExtension:()=>!!a||(document.documentElement.getAttribute("airtime-extension-installed")&&(a=!0),a),detectExtensionComms:()=>!!s||(document.documentElement.getAttribute("airtime-extension-clientcomms-installed")&&(s=!0),s),isFuncNative:c,getNativeFunction:d,getNativeFetchIfSupported:()=>{try{if(this.foundFetch)return this.foundFetch;if("undefined"!=typeof fetch&&c(fetch))return this.foundFetch=fetch,fetch;const e=d("fetch");if(void 0!==e&&c(e))return this.foundFetch=e,e}catch(e){o.warn("getNativeFetchIfSupported Err:",e)}},getHeadElem:()=>{try{return document.head||document.documentElement}catch(e){return document.documentElement}},getBodyElem:()=>{try{return document.body||document.documentElement}catch(e){return document.documentElement}},animFrameDebounce:u,draggableHelper:(e,t,n="bottom-right")=>{const o=t=>{const n=window.innerHeight-e.clientHeight;return t<0?0:t>n?n:t},r=t=>{const n=window.innerWidth-e.clientWidth;return t<0?0:t>n?n:t},i=t=>{e.style.left=e.style.right=e.style.top=e.style.bottom="",void 0!==t.top&&(e.style.top=o(t.top)+"px"),void 0!==t.bottom&&(e.style.bottom=o(t.bottom)+"px"),void 0!==t.left&&(e.style.left=r(t.left)+"px"),void 0!==t.right&&(e.style.right=r(t.right)+"px");const n=window.innerWidth/2,i=t.left>=n||t.right<n?"RightSide":"LeftSide";e.className=`am-PoweredByBitTube ${i}`},a=()=>{const t={bottom:window.innerHeight-document.body.clientHeight,right:window.innerWidth-document.body.clientWidth},n=e.offsetTop,o=e.offsetLeft,r=((e,t)=>{const n=e>=window.innerWidth/2?"right":"left";return`${t>=window.innerHeight/2?"bottom":"top"}-${n}`})(o,n),[a,s]=r.split("-");let c={anchor:r};return c[a]="top"==a?n:window.innerHeight-n-27-t.bottom,c[s]="left"==s?o:window.innerWidth-o-183-t.right,i(c),c},s="airtimeDraggablePos-"+e.id,c=()=>{const e=a();localStorage.setItem(s,JSON.stringify(e))};(()=>{try{let e=JSON.parse(localStorage.getItem(s));null===e&&(e=(()=>{let e=n;-1==["top-left","top-right","bottom-left","bottom-right"].indexOf(e)&&(e="bottom-right");const[t,o]=e.split("-");let r={};return r[t]=40,r[o]=40,r})()),i(e)}catch(e){}})();const d=u(function(t){if(e.moveCount++,!(e.moveCount<=3)&&e.isClicked){e.isMoving||(e.isMoving=!0,e.classList.add("airtime-dragged"));const n={left:r(t.clientX-e.dragStartX),top:o(t.clientY-e.dragStartY)};i(n)}});function l(){document.removeEventListener("mousemove",d,!1),document.removeEventListener("mouseup",l,!1),e.isClicked=!1,e.isMoving?(e.isMoving=!1,e.classList.remove("airtime-dragged"),c()):t()}e.addEventListener("mousedown",function(t){if(1!==t.which)return!1;e.dragStartX=t.offsetX,e.dragStartY=t.offsetY,e.isClicked=!0,e.moveCount=0,document.addEventListener("mousemove",d,!1),document.addEventListener("mouseup",l,!1)},!1);window.addEventListener("resize",u(()=>{a()}),!1)},checkBrowser:function(){let e=navigator.userAgent.indexOf("Chrome")>-1,t=/Edge\/\d./i.test(navigator.userAgent),n=navigator.userAgent.indexOf("Firefox")>-1,o=navigator.userAgent.indexOf("Safari")>-1,r=navigator.userAgent.indexOf(" OPR/")>-1;return e&&o&&(o=!1),e&&t&&(e=!1),e&&r&&(e=!1),e?"chrome":n?"firefox":o?"safari":t?"edge":r?"opera":void 0},IdGenerator:l,asyncDelay:(e=1e3)=>new Promise(t=>{setTimeout(t,e)}),asyncImmediate:()=>new Promise(e=>{t(e)}),isElemVisible:e=>!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length),eventIsTrusted:e=>e instanceof Event&&!0===e.isTrusted,getGuestUUID:()=>{if(!m)try{m=localStorage.getItem("airtime-guuid"),i(m)||(m=void 0)}catch(e){}if(!m){m=function(e,t,n){return t>e.length-1?e:e.substr(0,t)+n+e.substr(t+1)}(m=r(),14,"f");try{localStorage.setItem("airtime-guuid",m)}catch(e){}}return m},roundToSignificant:(e,t=3)=>{const n=e.toString();if(-1!==n.indexOf("e"))return NaN;const[o,r]=n.split(".");if(!r)return+o;if(o>=1){const n=Math.pow(10,t);return Math.round(e*n)/n}const i=r.match(/^0+/),a=Math.max(t,(i&&i[0].length||0)+1),s=Math.pow(10,a);return Math.round(e*s)/s}}}).call(this,n("URgk").setImmediate)},l9JQ:function(e,t,n){"use strict";let o;const r=async()=>{return(await(()=>new Promise((e,t)=>{try{if(o)e(o);else{const n=indexedDB.open("airtime-module",6);n.onupgradeneeded=function(){n.result.objectStoreNames.contains("objectStore")&&n.result.deleteObjectStore("objectStore"),n.result.createObjectStore("objectStore",{keyPath:"_key"})},n.onsuccess=(t=>{o=n.result,e(o)}),n.onerror=t}}catch(e){t(e)}}))()).transaction("objectStore","readwrite").objectStore("objectStore")},i=e=>new Promise(async(t,n)=>{try{const o=(await r()).get(e);o.onsuccess=(e=>{const n=e.target.result;"object"==typeof n&&n.hasOwnProperty("_key")&&delete n._key,t(n)}),o.onerror=n}catch(e){n(e)}});e.exports={getObject:i,putObject:(e,t)=>new Promise(async(n,o)=>{try{const a=await i(e)||{_key:e};Object.assign(a,t);const s=(await r()).put(a);s.onsuccess=(e=>{n(e.target.result)}),s.onerror=o}catch(e){o(e)}}),setObject:(e,t)=>new Promise(async(n,o)=>{try{const i={_key:e};Object.assign(i,t);const a=(await r()).put(i);a.onsuccess=(e=>{n(e.target.result)}),a.onerror=o}catch(e){o(e)}}),delObject:e=>new Promise(async(t,n)=>{try{const o=(await r()).delete(e);o.onsuccess=(e=>{t(e.target.result)}),o.onerror=n}catch(e){n(e)}})}},mjZG:function(e,t){e.exports={production:!0,logging_enabled:!1,firehose_debug:!1,events_debug:!1,api_airtime_ingress:"https://europe-west1-bittube-airtime.cloudfunctions.net/airtime-ingress/guest",api_airtime_ingress_user:"https://europe-west1-bittube-airtime.cloudfunctions.net/airtime-ingress/",api_get_content_uuid:"https://us-central1-bittube-airtime-extension.cloudfunctions.net/getPlatformContentID",extension_api:"https://us-central1-bittube-airtime-extension.cloudfunctions.net",errorBeaconURL:"https://europe-west1-bittube-airtime.cloudfunctions.net/beacon-ingress",clientFrameURL:"https://bittubeapp.com/tubepay/client.html",walletAPIURL:"https://mywallet.bittubeapp.com/",myWalletURL:"https://bittubeapp.com/wallet/"}},tijG:function(e,t,n){"use strict";const o=n("mjZG");e.exports={amClient:()=>window.location.href===o.clientFrameURL}}}]);